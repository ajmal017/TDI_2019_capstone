# TDI_2019_capstone
Capstone Project for The Data Incubator Fellowship
Deployed at https://still-shore-32206.herokuapp.com/bokeh_plot

Business Objective: Bots 4 Humans is an interactive web application to craft trade and deploy your own algorithm for trading financial instruments. The aim is to enable the casual investor to quickly and easily inspect price charts of a plethora of stocks, cryptos, and physical currencies and use a variety of different machine learning algorithms as well as traditional time series analysis (seasonal ARIMA) to make predictions about daily prices about the selected commodity. Each model makes its own prediction, empowering the creative user to recognize which model may best exploit various patterns in the price behavior, to ultimately inform competitive trades.  

Data ingestion: Bots 4 Humans utilizes Alpha Vantage API to access price information using the requests library. Additional economic data is accessed via the FRED API using the request_futures library. At runtime, this data is stored in pandas DataFrame objects. 

Visualizations: Bots 4 Humans is an interactive dashboard comprised of multiple dynamic plots and tables. The plots react to zooming, panning, scrolling, and hovering. Dropdown menus allow the user to select a commodity type, the commodity to inspect, and optionally the year and month to show. There is also a reset button that will rescale to show the entire history of the available price data.

Chart 1: The main chart shows the stock price in $USD vs. time up to the present, including the daily Open, Low, High, and Close. This information is also presented as Candlesticks, where a candlestick for a day is green (or red) is the close is higher (or lower) than the open, and the "wicks" depict the differences between the four prices. The default interaction on this chart is such that if the cursor is placed anywhere inside the chart, the scrolling action (mouse wheel, touchpad or hotkeys) will cause the horizontal axis to zoom in or out. Because the axes of Charts 1, 2, and 3 are linked, they will all change together. While this occurs, the data in the chart will vary, and the vertical axes will automatically adjust to rescale so that all the data remain contained in the chart. This is accomplished using JavaScript callbacks. 

Chart 2: The second chart shows the Moving Average Convergence Divergence, or "MACD". This is a plot that essentially shows the crossover points of two exponential moving averages with different half-lifes (12 vs 26 days). For reference, the associated moving averages are also plotted on Chart 1. In addition to the MACD and Signal lines, the MACD histograms are also plotted in the background. These are shown simply because they are customary views that traders are used to seeing. The default interaction on this chart is such that if the cursor is placed anywhere inside the chart, the scrolling action (mouse wheel, touchpad or hotkeys) will cause the horizontal axis to pan left or right. Because the axes of Charts 1, 2, and 3 are linked, they will all change together. Thus, scrolling over Charts 1 and 2 provide a smooth and convenient way to navigate through the price information at different temporal resolutions and periods. 

Chart 3: An area chart of the trading volume.

Chart 4: The fourth chart is a customized plot depicting the state of a number of categorical variables. These can be zero (white), positive (green) or negative (red). One or two can take on five instead of three values (dark green and red). Each variable here is known as a price action event indicator. Each indicator is associated with a deterministic function that determines its state at each point in time according to some rules that depend on the relationship between the current and previous price values. For more details, see . The functions used to compute the values were obtained from the talib package https://github.com/mrjbq7/ta-lib, which is a wrapper for the TaLib library http://ta-lib.org/. 

Chart 5L, 5R, 6L, 6R: This shows the price forecasts according to a seasonal ARIMA model. To use the forecasting tool, go to Chart 1 and select the Box Select (x-axis) tool from the toolbar at the right hand side of the chart. Using the Box Select tool, click and drag across a region of Chart 1. The selected region will be used to train the predictive models. This is accomplished by using Bokeh server. In this configuration, the selection triggers a real Python callback, the selected indices are captured, and the predictions are computed in realtime because the functions responsible are accessible to the Tornado event loop. First, the hyperparameters of a seasonal ARIMA model are selected by maximizing the Aikike Information Content score in the training window. In parallel to this, there are 11 different machine learning models that are also trained on this model. These models take the categorical indicators in Chart 4 as inputs and predict on them whether or not the closing or opening price on the following day will be greater. Once the models are trained, they are projected stepwise up to ten days into the future, and a new set of predictions is made for each of these "sliding windows". While the ML models predict only the day ahead, the ARIMA model makes forecasts for days 1-5 days ahead and yields confidence intervals for each prediction. These are plotted in Chart 5L. Chart 6L: This (just below 5L) shows the % Error (i.e., (Predicted - Actual) / Actual * 100%) of the data in 5L. Beside them on the right, Chart 5R shows the histogram of the errors in 6L, with the "yest" showing the error of the "day-behind" model, i.e. predicting tomorrow's price will the same as today's. Below in Chart 6R the same histogram data is depicted as a cumulative sum. It's important to note that the day-behind data is not limited here to the fitted window but shows its performance across the whole dataset, making it appear relatively better.      

Table 7: At the bottom of the dashboard the predictions from all 11 machine learning models are tabulated along with the the actual behavior ("Target") of the price, for each day (one day ahead) during the projections. The model is only fitted on the Box Selection, and then predicted of subsequent daily information during five sliding window projections with a step of one day.  

There is still a lot of work to be done to continue to grow and improve this project in many different directions. As is, it demonstrates a wide range of different technologies including an interactive website with graphics, time series analysis, a range of machine learning approaches consisting of Logistic Regression, Nearest Neighbors, Decision Tree, AdaBoost, Naive Bayes, QDA, Linear SVM,
Gradient Boosting Classifier, Gaussian Process, Random Forest, and Neural Network classifiers. The results of the project are instantiated in the feedback from the webapp, when the user selects a stock and highlights a region of interest and recieves the predictions. There is still much room for improvement, both in producing and tabulating prediction performance assessments, and in producing a better predictive ensemble leveraging all of the different models - quite possibly by identifying the conditions under which each model performs best. That being said, this app (as it is) lays the groundwork for further experimentation in identifying how to go about doing that. 
